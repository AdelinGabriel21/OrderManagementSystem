<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Contracts</title>
    <style>
        .filter-form {
            background-color: #f9f9f9;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
        }
        .filter-group {
            display: inline-block;
            margin-right: 15px;
        }
    </style>
</head>
<body>
<h2>Contract List</h2>

<div class="filter-form">
    <form th:action="@{/contracts}" method="get">
        <div class="filter-group">
            <label>Name:</label>
            <input type="text" name="name" th:value="${filterName}" placeholder="Search name..."/>
        </div>

        <div class="filter-group">
            <label>Status:</label>
            <select name="status">
                <option value="">-- All --</option>
                <option th:each="s : ${statusOptions}"
                        th:value="${s}"
                        th:text="${s}"
                        th:selected="${s == filterStatus}"></option>
            </select>
        </div>

        <div class="filter-group">
            <label>Created After:</label>
            <input type="date" name="fromDate" th:value="${#dates.format(filterFromDate, 'yyyy-MM-dd')}"/>
        </div>

        <div class="filter-group">
            <label>Created Before:</label>
            <input type="date" name="toDate" th:value="${#dates.format(filterToDate, 'yyyy-MM-dd')}"/>
        </div>

        <button type="submit">Filter</button>
        <a href="/contracts" style="margin-left: 10px;">Reset</a>
    </form>
</div>

<a href="/contracts/new">Add Contract</a>

<table border="1">
    <tr><th>ID</th><th>Name</th><th>ContractType ID</th><th>Status</th><th>Contract Line</th><th>Creation Date</th><th>Expiration Date</th></tr>
    <tr th:each="contract : ${contracts}">
        <td th:text="${contract.id}"></td>
        <td th:text="${contract.name}"></td>
        <td th:text="${contract.contractTypeId}"></td>
        <td th:text="${contract.status}">Status</td>
        <td th:text="${contract.contractLines != null ? #lists.size(contract.contractLines) : 0}">
            Contract Lines
        </td>
        <td th:text="${contract.creationDate}">Creation Date</td>
        <td th:text="${contract.expirationDate}">Expiration Date</td>
        <td>
            <a th:href="@{'/contracts/edit/' + ${contract.id}}">Edit</a>
            <a th:href="@{'/contracts/details/' + ${contract.id}}">Details</a>
            <form th:action="@{'/contracts/' + ${contract.id} + '/delete'}" method="post" style="display:inline;">
                <button type="submit">Delete</button>
            </form>
        </td>
    </tr>
</table>
</body>
</html>